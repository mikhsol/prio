# 1.2.3 Multi-Module Architecture

**Task**: Set up multi-module structure  
**Owner**: Android Developer  
**Status**: ✅ Completed  
**Date**: February 4, 2026

---

## Module Overview

The project follows a **feature-by-layer** architecture with 7 modules:

```
android/
├── app                 # Application entry point
├── core:common         # Shared models, utilities
├── core:ui             # Compose theme, components
├── core:data           # Room DB, repositories
├── core:domain         # Use cases, business logic
├── core:ai             # AI types, interfaces
└── core:ai-provider    # AI implementations (llama.cpp)
```

---

## Module Dependencies

```
                    ┌─────────────┐
                    │     app     │
                    └──────┬──────┘
                           │
           ┌───────────────┼───────────────┐
           │               │               │
           ▼               ▼               ▼
    ┌────────────┐  ┌────────────┐  ┌────────────┐
    │  core:ui   │  │ core:data  │  │   core:ai  │
    └─────┬──────┘  └──────┬─────┘  └─────┬──────┘
          │                │               │
          │                ▼               │
          │         ┌────────────┐         │
          │         │core:domain │         │
          │         └──────┬─────┘         │
          │                │               │
          └────────────────┼───────────────┘
                           │
                    ┌──────▼──────┐
                    │ core:common │
                    └─────────────┘
```

---

## Module Responsibilities

### app
- MainActivity and navigation
- Hilt application class
- Android manifest and resources
- Feature integration

### core:common
- Shared enums (EisenhowerQuadrant, GoalCategory)
- Common utilities
- Kotlinx Serialization types

### core:ui
- JeevesTheme (Material 3)
- Color tokens (quadrant colors per spec)
- Typography scale
- Reusable Compose components

### core:data
- Room database (JeevesDatabase)
- Entities (Task, Goal, Milestone, Meeting, DailyAnalytics)
- DAOs with Flow queries
- DataStore preferences
- Hilt modules for DI

### core:domain
- Use case interfaces
- Domain models (future)
- Repository interfaces

### core:ai
- AiRequest/AiResponse types
- AiProvider interface
- AiCapabilities definition
- Model registry types

### core:ai-provider
- Rule-based classifier implementation
- llama.cpp JNI integration (Phi-3-mini)
- Model download manager
- Provider router with fallback

---

## Build Configuration

Each module uses consistent configuration:

```kotlin
android {
    namespace = "com.jeeves.core.{module}"
    compileSdk = 34
    
    defaultConfig {
        minSdk = 29
    }
    
    compileOptions {
        sourceCompatibility = JavaVersion.VERSION_17
        targetCompatibility = JavaVersion.VERSION_17
    }
}
```

---

## Benefits of Multi-Module Architecture

1. **Parallel Compilation**: Independent modules build concurrently
2. **Build Cache**: Unchanged modules use cached artifacts
3. **Separation of Concerns**: Clear boundaries between layers
4. **Testability**: Test modules in isolation
5. **Reusability**: Common/UI modules ready for KMP expansion

---

*Document Owner: Android Developer*  
*Last Updated: February 4, 2026*
