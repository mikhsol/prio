<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

    <!--
    Debug manifest overlay.
    - Disables Firebase auto-initialization for debug builds (placeholder keys).
    - Replaces splash-screen theme with regular Theme.Prio so that
      installSplashScreen()'s OnPreDrawListener does not block the first
      Compose frame during instrumented tests.
    -->
    <application>
        <!-- Disable Firebase Crashlytics auto-init -->
        <meta-data
            android:name="firebase_crashlytics_collection_enabled"
            android:value="false" />
        
        <!-- Disable Firebase Analytics auto-init -->
        <meta-data
            android:name="firebase_analytics_collection_enabled"
            android:value="false" />
        
        <!-- Disable Firebase auto-initialization provider -->
        <provider
            android:name="com.google.firebase.provider.FirebaseInitProvider"
            android:authorities="${applicationId}.firebaseinitprovider"
            tools:node="remove" />

        <!--
        Override the splash-screen theme for debug builds.
        The splash screen's OnPreDrawListener blocks the first Compose
        frame, causing "No compose hierarchies found" in every E2E test.
        Using Theme.Prio directly bypasses this.
        -->
        <activity
            android:name="com.prio.app.MainActivity"
            android:theme="@style/Theme.Prio"
            tools:replace="android:theme" />

        <!--
        Disable BootReceiver in debug/test builds.
        During instrumented tests, Hilt is not yet initialized when Android
        delivers stale BOOT_COMPLETED broadcasts, causing:
        "The component was not created. Check that you have added the HiltAndroidRule."
        -->
        <receiver
            android:name="com.prio.app.worker.BootReceiver"
            tools:node="remove" />
    </application>

</manifest>
